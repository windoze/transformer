# t1 for demo
t1(fv as float, os as string, appBundle as string, osVersion as string)
| project bucketId = bucket(fv, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512), appBundleCrossOS = os + "_" + appBundle, majorOSVersion = to_string(split(osVersion, ".")[0])
| project-remove fv, os, appBundle, osVersion
;

t2(ip as string)
| lookup country, city from geoip on ip
;

t3(ip as array)
| explode ip as string
| lookup country, city from geoip on ip
;

t4(fk as int)
| lookup name from locationsvc on fk
| lookup avg = f_location_avg_fare, f_location_max_fare from feathrci on to_string(fk)
;

t5(fv as float, os as string, appBundle as string, osVersion as string, ip as string)
| lookup country, city, zip from geoip on ip
| project bucketId = bucket(fv, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512), appBundleCrossOS = os + "_" + appBundle, majorOSVersion = to_string(split(osVersion, ".")[0])
| project-remove fv, os, appBundle, osVersion
;
